# S&P 500 스타일 지수 백테스팅 프로그램

이 프로그램은 S&P 500 스타일 지수를 기반으로 월별 투자 시뮬레이션(백테스팅)을 실행하고, 결과를 수치와 그래프로 제공합니다.

## 주요 기능

- **데이터 로딩**: `sp500_data.xlsx` 파일에서 S&P 500 스타일 지수 데이터 읽기
- **사용자 입력**: 백테스팅 기간, 투자 지수, 초기 원금 설정
- **월별 백테스팅**: 선택한 기간 동안 월별 수익률 기반 포트폴리오 가치 계산
- **성과 분석**: 총수익률, CAGR, MDD 등 주요 성과 지표 계산
- **시각화**: 포트폴리오 가치 변화 그래프 생성 및 저장

## 필요한 라이브러리

```bash
pip install pandas openpyxl matplotlib numpy
```

## 파일 구조

- `sp500_backtesting.py`: 메인 백테스팅 프로그램
- `test_backtesting.py`: 자동 테스트 스크립트
- `sp500_data.xlsx`: S&P 500 스타일 지수 데이터 (필수)

## 사용 방법

### 1. 일반 실행 (대화형)
```bash
python sp500_backtesting.py
```

프로그램 실행 후 다음 정보를 순차적으로 입력:
- 백테스팅 시작 연도/월
- 백테스팅 종료 연도/월  
- 투자할 S&P 500 스타일 지수 선택
- 초기 투자 원금

### 2. 테스트 실행 (자동)
```bash
python test_backtesting.py
```

미리 설정된 파라미터로 자동 테스트 실행

## 사용 가능한 지수

- S&P500 Growth
- S&P500 Value
- S&P500 Momentum
- S&P500 Quality
- S&P500 Low Volatility Index
- S&P500 Div Aristocrat TR Index

## 결과물

### 1. 수치 결과 (터미널 출력)
- 최종 자산
- 총수익률
- 연평균 복리 수익률 (CAGR)
- 최대 낙폭 (MDD)
- 투자 기간

### 2. 시각화 결과
- `backtesting_result.png`: 포트폴리오 가치 변화 그래프

## 예제 실행 결과

```
==================================================
          백테스팅 결과
==================================================
선택된 지수: S&P500 Growth
초기 투자 원금: 10,000,000 원
최종 자산: 14,652,613 원
총 수익률: 46.53%
연평균 복리 수익률 (CAGR): 10.49%
최대 낙폭 (MDD): -30.88%
투자 기간: 3.8 년
==================================================
```

## 주의사항

- `sp500_data.xlsx` 파일이 같은 디렉토리에 있어야 합니다
- 첫 번째 열은 날짜 데이터여야 합니다
- 나머지 열들은 각 지수의 월별 종가 데이터여야 합니다
- 입력된 기간이 데이터 범위를 벗어나면 오류가 발생합니다

## 프로그램 구조

### 주요 함수
- `load_data()`: 데이터 로딩 및 전처리
- `get_user_input()`: 사용자 입력 처리 및 검증
- `filter_data_by_period()`: 기간별 데이터 필터링
- `run_backtesting()`: 백테스팅 로직 실행
- `calculate_performance_metrics()`: 성과 지표 계산
- `print_results()`: 결과 출력
- `create_and_save_chart()`: 차트 생성 및 저장